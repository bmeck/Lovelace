<script type="text/javascript" src="../../js/lovelace/Loader.js"></script>
<script type="text/javascript">
	Loader.Require("../../js/parser/Parser.js")
	Loader.OnLoaded(function(){
		try{
		var construct=new RegexCombination()
			|| RegexCombination.call({})
			|| RegexCombination.apply({})
		} catch (e) {}
		!construct?
			console.log("Passed construct prevention")
			:console.error("Construct created!")
		var base=RegexCombination();
		base!==RegexCombination()?
			console.log("Passed Uniqueness.")
			:console.error("Not unique construction!");
		var cast=RegexCombination(base);
		base==cast?
			console.log("Passed Casting - RegexCombination.")
			:console.error("Cast duplication!");

		//MATCH /a[bcd]/
		var parser=RegexCombination("a").concat(
			RegexCombination().any(/[bc]/,"d")
		)

		var match=parser.match("ac")
		match?
			console.log("Passed Parsing - matching string")
			:console.error("Parse Failure!");
		console.log("Parser:",parser,"Matched: ",match,String(match))
		parser.match("abcd")?
			console.log("Passed Parsing - failing string")
			:console.error("Parse Failure!");

		//MATCH Parentheses
		//Involves recursion
		var startParen=RegexCombination("(")
		var closeParen=RegexCombination(")")
		var parser=RegexCombination();
		parser=parser.concat(
			startParen
			,RegexCombination().any(parser,"")
			,closeParen
		).optimize();
		console.log(parser)
		var match=parser.match("(())")
		console.log("Matched: ",match,String(match))
		match?
			console.log("Passed Parsing - matching string")
			:console.error("Parse Failure!");
		match=parser.match("(()");
		console.log("Matched: ",{0:match},String(match))
		!match?
			console.log("Passed Parsing - failing string")
			:console.error("Parse Failure!");

		parser=RegexCombination(/^^start^line/)
		parser.match("start\nline")
		parser.match("notstart\nline")
	})
</script>